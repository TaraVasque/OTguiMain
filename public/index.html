<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #1a1a1a;
            color: rgb(255, 255, 255);
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #333;
            color: gold;
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .container {
            padding: 20px;
            max-width: 900px;
            margin-top: 80px;
        }

        button {
            padding: 12px 25px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: gold;
            color: black;
            margin: 10px 0;
            transition: opacity 0.3s;
        }

        button:hover {
            opacity: 0.8;
        }

        .form-container, .section {
            display: none;
            background-color: #222;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background-color: #444;
            border: 1px solid #555;
            border-radius: 5px;
            color: white;
        }

        .order-list {
            margin-top: 30px;
            background-color: #222;
            border-radius: 8px;
            padding: 20px;
        }

        .order-item {
            background-color: #333;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
        }

        .order-item p {
            margin: 0;
        }

        .order-item button {
            background-color: #dc3545;
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 5px;
            color: white;
        }

        #totalCost {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            text-align: right;
        }

        .receipt {
            padding: 15px;
            background-color: #333;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .receipt-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .receipt-item p {
            margin: 0;
        }

        .total-price {
            font-weight: bold;
            font-size: 22px;
            text-align: right;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Order Tracker</h1>
    </header>

    <div class="container">
        <button onclick="showSection('addOrder')">Add Order</button>
        <button onclick="showSection('viewOrders')">View Orders</button>
        <button onclick="showSection('totalCost')">Total Cost</button>
        <button onclick="showSection('exportOrders')">Export to Excel</button>
        <button onclick="showSection('importOrders')">Import from Excel</button>

        <div id="addOrder" class="form-container">
            <h2>Add New Order</h2>
            <form id="addOrderForm">
                <label for="orderName">Order Name</label>
                <input type="text" id="orderName" placeholder="Enter Order Name" required><br>
                
                <label for="orderPrice">Price ($)</label>
                <input type="number" id="orderPrice" placeholder="Enter Price" required><br>
                
                <label for="orderType">Order Type</label>
                <input type="text" id="orderType" placeholder="Enter Order Type (e.g. Dine-in, Takeout)" required><br>
                
                <label for="orderPhone">Phone Number</label>
                <input type="text" id="orderPhone" placeholder="Enter Phone Number" required><br>
                
                <button type="button" onclick="addOrder()">Add Order</button>
            </form>
        </div>

        <div id="viewOrders" class="section">
            <h2>View Orders</h2>
            <div id="orderList" class="order-list"></div>
        </div>

        <div id="totalCost" class="section">
            <h2>Total Cost</h2>
            <div id="receipt" class="receipt"></div>
            <div id="totalCostValue" class="total-price"></div>
        </div>

        <div id="exportOrders" class="section">
            <button onclick="exportOrders()">Export Orders to Excel</button>
        </div>

        <div id="importOrders" class="section">
            <button onclick="importOrders()">Import Orders from Excel</button>
        </div>
    </div>

    <script>
        // Switch sections and ensure only the selected one is visible
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section, .form-container');
            sections.forEach(section => {
                section.style.display = 'none'; // Hide all sections
            });
            document.getElementById(sectionId).style.display = 'block'; // Show the selected section
        }

        // Fetch orders and update UI
        function fetchOrders() {
            fetch('/orders')
                .then(response => response.json())
                .then(data => {
                    const orderList = document.getElementById('orderList');
                    orderList.innerHTML = '';
                    data.forEach((order, index) => {
                        const orderItem = document.createElement('div');
                        orderItem.className = 'order-item';
                        orderItem.innerHTML = `
                            <div>
                                <p><strong>Order:</strong> ${order.name}</p>
                                <p><strong>Type:</strong> ${order.type}</p>
                                <p><strong>Price:</strong> $${order.price.toFixed(2)}</p>
                                <p><strong>Phone:</strong> ${order.phone}</p>
                            </div>
                            <button onclick="deleteOrder(${index})">Delete</button>
                        `;
                        orderList.appendChild(orderItem);
                    });
                });
        }

        // Fetch and display total cost in a receipt-like style
        function displayTotalCost() {
            fetch('/orders')
                .then(response => response.json())
                .then(data => {
                    const receipt = document.getElementById('receipt');
                    const totalCost = data.reduce((total, order) => total + order.price, 0);

                    receipt.innerHTML = ''; // Clear previous receipt
                    data.forEach(order => {
                        const receiptItem = document.createElement('div');
                        receiptItem.className = 'receipt-item';
                        receiptItem.innerHTML = `
                            <p><strong>${order.name}</strong></p>
                            <p>$${order.price.toFixed(2)}</p>
                        `;
                        receipt.appendChild(receiptItem);
                    });

                    document.getElementById('totalCostValue').innerText = `Total Cost: $${totalCost.toFixed(2)}`;
                });
        }

        // Add new order
        function addOrder() {
            const name = document.getElementById('orderName').value;
            const price = parseFloat(document.getElementById('orderPrice').value);
            const type = document.getElementById('orderType').value;
            const phone = document.getElementById('orderPhone').value;

            if (!name || isNaN(price) || price <= 0 || !type || !phone) {
                alert('Please fill in all fields correctly.');
                return;
            }

            fetch('/orders', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, price, type, phone })
            })
            .then(response => response.json())
            .then(() => {
                alert('Order added successfully');
                fetchOrders();  // Refresh the order list
                document.getElementById('addOrderForm').reset();  // Reset form fields
            })
            .catch(error => console.error('Error:', error));
        }

        // Delete an order
        function deleteOrder(index) {
            fetch(`/orders/${index}`, { method: 'DELETE' })
                .then(() => {
                    alert('Order deleted successfully');
                    fetchOrders(); // Refresh the order list
                })
                .catch(error => console.error('Error:', error));
        }

        // Export orders to Excel
        function exportOrders() {
            fetch('/export')
                .then(response => response.json())
                .then(data => alert(data.message));
        }

        // Import orders from Excel
        function importOrders() {
            fetch('/import', { method: 'POST' })
                .then(response => response.json())
                .then(data => alert(data.message));
        }

        // Initial setup
        window.onload = function() {
            showSection('viewOrders');  // Show view orders by default
            fetchOrders();  // Load the list of orders
            displayTotalCost();  // Display the total cost
        }
    </script>
</body>
</html>

